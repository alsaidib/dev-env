service: fastify-dev-env-serverless

provider:
  name: aws
  runtime: nodejs8
  websocketsApiRouteSelectionExpression: '$request.body.type'

# Functions
functions:
  fastify-serverless-api:
    name: ${self:service}-${self:provider.stage}-fastify-serverless-api
    handler: lambda.handler
    timeout: 30
    events:
      - http:
          path: '{proxy+}'
          method: any
      - websocket:
          routeKey: $connect
      - websocket:
          routeKey: $disconnect
  connect:
    handler: handler.connect
    events:
      - websocket:
          route: $connect
  disconnect:
    handler: handler.disconnect
    events:
      - websocket:
          route: $disconnect

# Plugins
plugins:
  - serverless-dotenv-plugin
  - serverless-offline
  - serverless-websockets-plugin
